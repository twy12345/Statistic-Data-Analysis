# 统计学学习

***统计学不研究统计，它研究的是不确定性***


统计的基本思想: ***从随机性中寻找规律性***

统计思想的基本方法：***从样本性质推断总体性质***

推断的两大支柱就是：***概率和误差***，并贯穿于整个统计学的几乎所有关键点。

统计学最终归结到两个核心理念:***允许误差下的概率保证;允许误差下的统计推断***。

统计思维模式主要包括：  
均值模式  
变异模式  
估计模式  
相关模式  
拟合模式  
检验模式  
归纳模式  
比较模式  

均值模式：均值是对所要研究对象的简明而重要的代表。均值模式要求从总体上看问题，观察事物一般的发展趋势，避免个别偶然现象的干扰，体现了总体观、数量观和推断观。

变异模式：均值也代表了某种变异，否则无从谈起。统计研究对象中的个体必须存在差异。统计方法就是要认识事物数量方面的差异。在统计学中，用来反映变异的概念是方差，表示离散程度。平均与变异都是对具有同类个体的总体特征的抽象和宏观度量。

估计模式：估计模式是应用某种合理的方法，通过对有限量的样本的分析，对未知事物或者未发生事物进行估计推测的思想，由一个事物的特点和规律来推测其他事物，对其进行认识。使用估计方法有一个前提条件，那就是获取的样本应与总体具有类似的性质。在某种条件下，样本才能代表总体。在估计过程中，要保持逻辑的严谨性。

相关模式：并不是所有的事物之间都存在着严格的因果关系。在某些统计样本的变化过程中，经常会出现一些其它事物相随共变或相随共现的情况。我们把这种非确定性关系的相随共变叫做统计相关性。它们之间不存在确定的函数关系，也会有奇异值出现。

拟合模式：在统计世界中，个体显随机性，群体显规律性。拟合是对群体规律性的抽象，即公式化或模型化。一旦事物的变化被模型化，我们就找到了解决问题的方法，知道了变化趋势。

归纳模式：由某类事物中部分对象的特征,推断出该类事物的全部对象的特征,或者由个别事实概括出一般结论的推理叫做归纳推理。归纳推理是由部分到整体,由个别到一般的推理。推断性统计的由随机抽样样本性质推断总体性质的方法就是归纳的方法。有时归纳法得出的结论未必真实，因此还需要用实际样本资料对结论进行检验。

检验模式：推断性统计的依据就是归纳法。归纳法得出的结论永远是概率性质的。为了保证基于局部特征和规律所推断出来的对整体的判断的可信度，我们需要增加一道检验过程，就是利用实际样本资料来检验事先对总体某些数量特征的假设是否正确。

比较模式：统计的比较模式是依照比较的思维逻辑将比较对象与比较标准进行比较对照，计算出现象数量上的差别和变化，进而对比较对象做出评价和判断的一种统计思维方式。它包含比较的标准、比较的方式和比较的原则等具体内容。统计的比较模式在相对指标、变异指标、时间数列分析、指数、抽样推断和相关分析中都得到了有效的运用。


## 1. 统计学实验设计，及背后的知识

***设计实验的原则，是尽可能的控制实验中出现的变量，如果需要，则可以使用分组的方式处理那些无法通过主观行动影响的实验***

### 1) 对照实验

对照实验，即通过控制实验中的变量，对实验过程和结果进行**比较**。 对照实验是常用的实验方式，可以用于检验药物的有效性等。  
对照实验的关键在于分组：比如检验药品的有效性当中，可以通过认为的设置**处理组（提供药品）** 和 **对照组（提供安慰剂）**  

为了保证实验结果，实验过程需要保证随机：实验分组随机，过程双盲（实验者和实验者在均不知情的情况进行实验于统计）

同时，统计学上，为了避免**偏性**,需要进一步的控制对照组和处理组间的变量，防止出现因其他变量对实验结果进行**混淆**，这需要使得除了处理/实验这点之外，两组尽可能的相似  
以药物实验为例，为了避免因家庭条件（富裕家庭比贫穷家庭营养更好导致抵抗力更强）引起的偏性，则需要在对照组和处理组内部再增加一个家庭环境的分组，以进行对比。

在分组开始前，需要对参与实验的对象进行检查，保证他们均符合条件，例如：参与新冠疫苗实验的实验对象，不能患有新冠

整体实验中，两个分组的绝对数量不是关键，只要保证在同一数量级即可，因为最终判断结果数据时，可以使用比率而非绝对数据进行判断。

### 2) 历史对照实验

历史对照组，即将使用新方法的实验对象作为实验组，将之前使用老方法的实验对象设置未对照组，通过比较实验组和对照组确定结果。

例如：确定新药的有效性：将使用新药和老药的实验对象进行比较。

对于历史对照实验来说，需要控制历史对照组和实验组之间的差异，以避免可能出现的偏性。

## 总结

1. 统计学家使用比较的办法，试图搞清处理(接种疫苗)对反应(感染新冠)的效应。为了找到这两者的关系，他们把处理组和对照组中同分组的反应/结果之间进行对比
2. 在保证处理组和对照组仅仅在实验上出现区别，其他点上没有区别的情况下(避免混淆)，这两个组对比的结果就应该是实验的效果
3. 在使用随机对照实验的情况下，为了保证处理组和对照组条件相同，应尽量使用随机抽取的方式从实验对象中选择处理组和对照组
4. 对照组使用的安慰剂，应是中性的但是近似处理组使用的试剂
5. 随机实验应遵循双盲实验原则，即实验对象不清楚自身是在处理组还是在对照组，而研究人员也同样不知道这点，以免人事行为及之后评估过程中产生偏性

### 2) 观察研究

观察研究和对照实验不同，对照实验中，研究者决定对照组，而观察实验当中的分组是自然形成的，研究人员仅仅是客观的观察整体结果

***相对对照实验，观察研究中分组流程中，很有可能存在一定的偏性（例如吸烟的人群和不吸烟的人群进行比较，吸烟的人群的收入可能更低，因此影响了两个组的寿命）。为此，观察实验中，首先应该理清对照组和处理组之间的关系，以避免混淆***

针对对照组和处理组之间的混淆问题，最好的解决办法是通过创建子分组的方式控制变量。

控制变量的方法，可以用于针对较小且较均匀的分组进行偏性处理。例如：比较吸烟者和不吸烟者健康情况，以判断吸烟是否真正影响健康的实验中，因为吸烟者客观下以男性居多，且年龄偏大，故从整体上看会收到性别影响

为了排除这些影响，则应该针对**不同年龄层**的**男性吸烟者和男性非吸烟者/女性吸烟者和女性非吸烟者**进行观察实验。通过这种控制行为，可以事实上的避免性别和年龄分布不均的原则，对对照组和处理组返回的结果产生的影响。

***相关性并不等同于因果关系***

糙皮病案例：  
糙皮病（一种皮肤病）在18世纪被欧洲贫困地区的医生首次观察到，因为和某种吸血苍蝇的地理活动区域相同，一直被认为是由此类苍蝇传染的。但在20世纪，糙皮病被发现是因为缺乏烟酸(P-P因子)造成的，烟酸天然存在肉/蛋/奶/部分蔬菜和谷物当中，但是不存在于玉米(穷人的主要食物)当中。饮食上的限制才是糙皮病的主要病因，而苍蝇只是贫穷的标志，不是病的起因。

***针对通过观察研究中存在的混淆问题，可以通过设置更多较小的/均匀的子组进行调整这被称为：控制混杂因素***

例: 加州大学入学性别分析：  
从宏观角度上，加州大学以性别划分的入学率当中，男性占比44%，相比女性占比35%来说，确实存在一定入学歧视，得出这种判断潜在的假设是:  
1. 男女申请资质相同
2. 每个专业对招收男/女的倾向大体相同
通过对100个系中，占据30%比例的6个系的男/女录取率进行分析，可以发现：
1. 从录取率上来看：6个系中男/女的录取率相近，没有显著区别
2. 从绝对值上看，男/女在6个系的总数上没有太大差距，但是在分布上出现了较大差异：女性申请人更多集中在6个系中的4个系当中，而男性申请人则更多的集中在6个系当中的前两个系当中
根据之后调查的结果发现：6个系的申请难度并不相同，前两个系相对易于申请，而前两个系恰恰是男性集中申请的系，而其他四个系相对难以申请，但是集中了大部分的女性申请人

故，可以得出结论：表面上的申请差异是由男/女申请人申请系的分布引起的，底层原因则是因为每个系的申请难度不同，即：男性申请容易录取的专业，而女性则多申请录取难度高的专业

|专业|申请人数（男）|录取百分比（男）|申请人数（女）|录取百分比（女）|申请总数|
|:--|:--|:--|:---|:---|:---|
|A|825|62|108|82|933|
|B|560|63|25|68|585|
|C|325|37|593|34|918|
|D|417|33|375|35|792|
|E|191|28|393|24|584|
|F|373|6|341|7|714|

为了便于进行混淆控制，可以引入加权平均数的方式对申请率进行计算，此处的加权数即为申请总数：

男性加权平均入学率：  

    (62%x933 + 63%x585 + 37%x918 + 33%x792 + 28%x584 + 6%x714) / sum(933,585,918,792,584,714) 

39%

女性加权平均入学率：  

    (82%x933 + 68%x585 + 34%x918 + 35%x792 + 24%x584 + 7%x714) / sum(933,585,918,792,584,714)  

43%

最终得到结论：男/女申请人加权平均录取率相同，无性别歧视


# 描述性统计

针对于大部分统计数据，因为样本量较多，均需要使用描述性统计的方法对全部数据进行概括

## 1. 变量

变量，指的是研究中*因调查对象不同*而*产生差异*的*特性*。  
变量可以分为定性变量（婚姻情况，就业情况）与定量变量（年龄，收入）。  
变量可以是连续的或离散的：离散变量中，不同对象提供的变量间的差距应是固定且仅在一定范围内的（家庭规模）。而连续变量间的差距则是不固定的（年龄，一年、一个月、一天）  
在研究中，定性数据是由定性变量收集的

### 变量控制

在一般的实验当中，不会仅仅针对一项变量进行试验。  
例如：针对药物的实验中，会有血压，效果等多项变量。针对每个变量都要做好变量的控制工作：针对**血压**这个变量的测量工作中，也需要考虑到年龄的分组控制
这种情况下，可以使用交叉表列出实验组和对照组，所有年龄段下，不同血压的人数的比例

## 2. 平均数与标准差

在统计学中，**平均数**和**中位数**都用于寻找数据的中心（算数中心和实际中心），而**方差/标准差**用于度量平均数的散步程度（散步约大，方差/标准差越大），**四分位数间距**则是数据散步的另一种测度。

### 平均数中位数与方差

***一个数列的平均数，等于他们的和除以他们的个数的总数。***  
***一个数列的中位数，等于数列从小到大排列，此时数组最中间部分的标量数字就是中位数，如果数组为偶数，则为中间两个数的平均值***

平均数是一个用于*概括数据*的强有力的办法，但是这种浓缩仅仅通过*消除数据个体间的差异*而得到。有些差异则会被平均数掩盖掉。  
理想情况下，数据的分布应该是均匀的，所以平均数应该等于中位数。但是实际情况下，两个数据往往存在差异，而此时平均数两端的数据分布并非50%对50%。而中位数的两边数据分布均为50%对50%，即在直方图中，中位数左/右两边面积相等

为了统计平均数(算数中心)和中位数(实际中心)之间的差距，可以使用方差进行度量。  
方差是在概率论和统计方差*衡量随机变量或一组数据时离散程度的度量*，方差用来计算*每一个变量（观察值）与总体均数之间的差异*。  
方差的计算公式：SUM((数组中项目-数组平均值)^2)/len(数组)

### 剖面/纵向调查

剖面调查指的是：不同的研究对象，在*同一时间点*与其他实验对象*相互*进行比较  
纵向调查指的是：实验对象在整个实验中被持续跟踪，且和*自身*在*不同时间点*的记录进行比较

### 均方根与标准差

标准差/Standard Division（SD）用于计算数列中*同时出现了正/负两种数据*的情况下，*数据的分布*，即一个数列关于其平均数的散布。  
方差度量了数组偏离平均数的大小，这是一类平均偏差。标准差表示了数列中的数离散于它们的平均值有多远。大多数情况下，数列中的数项离开平均数一个SD单位，极少数数项偏离了2个及3个以上的SD。  
粗略的说，数组中三分之二的数项（68%）在离平均数+-1SD范围内，其余32%离的较远；20分之19的数项（95%）在距离平均数+-2SD的范围内，而5%则远之；此规则适用于大部分数列。这也是置信区间设置为95%的原因。  

均方根是一种*降低偏性*时常用的计算方法，在数据统计分析中，**将所有值平方求和，求其均值，再开平方，就得到均方根值**。在物理学中，我们常用均方根值来分析噪声。

均方根计算指的是：(SUM(((数组中项目)^2))/len(数组))再开根号，均方根计算了去除符号后，数列的项有多大；标准差计算的是偏离平均数（平均数偏差）的均方根。

标准差计算指的是：(SUM(((数组中数项目-平均数)^2))/len(数组))再开根号  
另一种计算方法：((项数)^2的平均数-(数项平均数)^2)再开根号

# 正态分布

### 正态曲线

因为相像，直方图可以近似划为一条曲线/正态曲线（正态近似），正态曲线用于代替统计数据常用的直方图，方便进行数据比较工作。

正态曲线公式：100% / 根号(2Π) * e^-(x^2/2)，其中e=2.71812

正态曲线关于0点对称，故数据0点即为平均值点，又为中位数点，且曲线下面积等于100%，标准的正态曲线数据应服从：  
+-1标准差单位间的正态曲线面积为68%，+-2标准差单位间的正态曲线面积为95%，位于曲线首/尾两个部分约占数据的十万分之六。

***标准单位个数是指的一个数值在平均数之上/之下多少个SD***

正态曲线内部表面积的求法：依据已知的+-1SD 面积为68%，和+-2SD为95%（这被称之为正态表），且正态曲线依据0点完全对称来推算面积

***一列数，如果遵循正态分布，落在一个给定区间项的百分数可以通过将区间转换为标准差单位(SD)，然后求正态分布曲线下相应的面积而估值。这个过程被称之为正态近似***

正态近似的求值：首先将区间转化成标准差单位(SD)，其次求正态曲线下相应的面积，最后将两步合在一起，

### 百分位数和四分位数

平均数和标准差单位(SD)仅能用于概括服从正态分布的数据，**但是一般情况下，数据不会完美的服从正态分布，而会从在长尾/左偏/右偏等情况**。  
为了概括这种数据，可以使用*百分位数*，即按照数据大小从小到大排列后，依据相同间隔（百分比）将数据分割成多个区间；当中，**第50百分位应正好是数据的中位数**。  
针对常见的几个由百分位数的取值点，可以推出**四分位数，即将数据从小到大排列后进行四等分，每个数据间隔为25%，并观察位于数据0%，25%，50%，75%和100%的几个点的数据。**  
四分位间距，在当**SD因数据分布不遵循正态分布而导致对曲线尾部面积进行了过多关注时**，用于**测量数据散布**，***所有曲线/直方图,无论是否遵循正态分布，均可以使用百分位数对数据进行概括***。

而当数据分布直方图遵循正态分布时，可以根据曲线的 **平均数** 和 **标准差单位(SD)** 对数据本身进行重构，这种情况下，平均数和SD是好的概括统计量。

例:  
数学SAT考试平均分为535，SD为100，求95百分位数。  
正态表中，以0点为准的占据+-2SD部分占据了全部数据的95%，但是此时说的95百分位数，则是说*数据从最小点，到数组的第95百分位*，即故原来的正态分布表中标定的数据在此时将不能使用。但是可以借用**正态近似**的思想，通过曲线面积求解：根据正态表，在服从正态分布的数据中，可以使用SD来表示数据的离散。第95百分数所在的点以在正态分布直方图中对应的点为5%数据所在的点。现在要求的是，5百分位至95百分位之间的面积，且5百分位至95百分位两点的SD值。5百分位和95百分位点中，占据了整个曲线的90%（100%-5%-5%，100%的面积减去了5百分位左边的5%的面积，和95百分位右边5%的面积），想在的问题是：90%阴影面积下的SD值是多少。通过+-2SD占据95%的情况可知，此位置应在2SD之内，约为1.65个SD，即为100 * 1.65 = 165分。故，95百分位则为535+165 = 700分

# 误差与测量误差

***每次单独测量值 = 精确值 + 机会误差***

误差无处不在，理想状况下，如果数据经过多次测量，每次测量的到的结果应该完全相同。但是实际情况下，因为**机会误差**存在的原因，数据每次测量得到的结果一定存在不同。  
机会误差的来源很难搞清，在一般的称量情况中，可能出现机会误差的原因包括但不限于：砝码/测量仪器的磨损，测量时的气温/气压，测量地点的重力等  
一般情况下，测量/处理机会误差的方法，是**经过多次测量后取所有结果的平均值**，这样的话机会误差将会平分给多个结果，这样就能进一步减小机会误差了，这被称之为**中心极限理论**。

***中心极限理论：设想我们重复称量一枚实际重量为5g的砝码。即使我们没有任何的操作失误，结果仍然会是 5.01g, 4.98g, 5.03g, .... ，不停徘徊，但大都处于真实值附近。这些变化来源于无法避免的随机误差。高斯则实际推导出了，这些随机误差应该服从正态分布。经过拉普拉斯，高尔顿等人的发展，我们最终得到了“中心极限定理”。简要一点可以这么说，当样本量趋于无限大的时候，样本均值减去理论均值渐近服从中心为0的正态分布。***

无论怎么测量，测量值都可能不同于真实值，如果重复一次，将显示一次的不同。为了得到一个值得信赖的值，则需要多次重复实验，通过得到的数据进行判断。  
机会误差使得每次单独测量值偏离精确值，偏离大小随着不同测量而变化，**在标准情况下，重复误差的变化性可以代表机会误差的变化性**。
***一系列重复测量值的标准差(SD)是单次测量中的机会误差可能大小的估计***

## 离群点

在正常的测量过程中，必定存在部分数据大幅偏离/远离大部分的测算数据，这些数据被称为**离群点**。  
在计算描述性统计，和拟合正态曲线的过程中，离群点的存在会成为干扰。当研究者看到一个离群点时，需要决定**是否因为接受此点数据而影响到数据的正态曲线的拟合**，**亦或者决定放弃此点**。

如果决定是否放弃离群点：如果数据量相对有限，且希望**坚持数据的客观性**以**避免任何人为的主观筛选过程**，则应该保留离群点。（离群点客观存在且不是因为流程错误所引起，为使得数据和正态曲线拟合而人为且主观的对数据进行筛选，数据将无法很好的表现当前的客观现实情况）如果修改少量离群点即可使得原始数据拟合正态曲线，则可以酌情去掉离群点。

## 偏性/系统误差

在数据测量当中，**偏性以相同的方式影响每个测量值，将它们推向同一个方向**；而**机会误差则随着不同的测量变化而变化，时上时下。**

例如：在卖菜的菜贩子秤砣上的吸铁石：引起秤砣重力变化使得每次测量得出的数据均偏大/小。

***理想情况下，通过统计多次重复实验，机会误差应会被抵消，重复测量值的平均数将给出测量物体的精确值（理想条件下机会误差也应符合正态分布）***  
但因为偏性存在的原因，测量的平均数将大于/小于精确值；偏性会使得每次测量得到的结果偏离真正的值：***单独测量值 = 精确值 + 偏性 + 误差 ***

通过对测量数据的观察无法客观发现偏性，一般会通过和客观标准比对(1千克秤砣和标准千克比较)或者和理论进行比较发现。

# 点和线

线由无数个点组成，在笛卡尔平面直角坐标系中，一个点的坐标可以写为(x,y)

### 线的斜率和截距

在一条线上，从一点A沿直线移动至点B，那么因为A点和B点移动所产生的x轴上的数据增长/减小（负增长）/变化被称之为**前移**，而Y轴上的数据增长/减小（负增长）/变化则被称之为**上升**。  
在一条直线中，无论取哪两个点，上升一定是前移的一半，**上升和前移的比率被称之为斜率：斜率 = 上升 / 前移；斜率是沿直线随X增加Y的比率/形成的夹角的陡峭程度***。  
***斜率为正则直线是上升的，为负则直线是下降的***。

直线的截距是指：***X = 0时 Y的值/高***

***斜率的实质：y变化一个单位和x变化一个单位的比，即：在同一直线上的两点(x1,y1) 和 (x2,y2)中，y变化一个单位(y2-y1) / x变化一个单位(x2-x1)***

### 由点和斜率确定直线/直线的函数

当直线经过点(2,1) 且斜率为1/2，求直线:

函数计算法:  
由直线经过点(2,1)，斜率为1/2可知：
    x = 2,y = 1，且y / x = 1/2，故可得到如下函数：y = 1/2 * x

画图法：  
画出点(2,1)后，向前前移3，根据斜率公式可得出，此时一点应为 1/2 * 3 = 1.5。由此得到两点(2,1)和(3,1.5)后，通过两点确定/施划直线。

***方程 y = mx + b 为一条直线，且斜率为m,截距为b***

# 相关

相关及相关性是统计学研究的重要组成部分。涉及到相关的知识时，一般情况研究的是**两个及两个以上变量之间的关系**。例如父亲身高和儿子身高之间的关系。  
通过绘制父亲身高与儿子身高之间的散点图（没对实验对象中，父亲身高值为x，儿子身高值为y），可以对父亲身高和儿子身高这两个变量进行分析。  
通过判断绘制出的散点图的倾向：整体向右上则x/y为正相关（随着x的增长y同时进行增长），通过观察可知：儿子身高父亲身高有关且呈正相关。但是通过散点图中点的散步可知：如果散步相对集中在一条线上(y=+-x)则可说明两个变量之间相关性强，反之如果散点图中点相对分散，则相关性若。如果相关性较强，则已知一个变量对预测另一个变量存在帮助，反之则无帮助。

通常情况下，仅在自身产生变化的变量被称之为**自变量**，因为自变量变化影响下变化的量为**因变量**。例中，希望了解儿子的身高是否受到父亲身高的影响，则父亲身高为自变量而儿子身高为因变量。

## 相关系数

针对普通的单变量数据，一般可以使用平均数/标准差等描述性统计指标对数据进行概括。针对两个变量的数据，因为存在两个变量/二维的原因，无法使用原先的指标。  
针对二维以上的数据，可以以下指标对数据进行描述:

**平均数点**:变量x和变量y各自的平均数组成的点，即散点图散步的中心点  
**水平/垂直散步度**：在理想情况下，x轴和y轴数据也应该符合正态分布，故可以使用x轴数据的标准差值（SD）和y轴数据的标准差值（SD）计算出水平SD和垂直SD。依据正态曲线表可知，大部分的数据都会集中在+-2SD中，故可以使用**x轴数据+-2SD的值**和**y轴数据+-2SD**的值来描述**水平/垂直散步**。  
**相关系数**：相关系数缩写为r，用于描述x和y两个变量之间的关系。相关系数是线性相关或围绕直线群集程度的一种度量。


### 相关系数的计算

***将每个变量都转化为标准单位(SD)时，乘积的平均数即为相关系数***

将自变量记为x，因变量记为y，相关系数记为r，则：  
***r = mean([(使用SD表示X)x(使用SD表示y)])***  
***mean(x = [(x数项-平均值)/SD] * y = [(y数项-平均值)/SD])***

计算过程：  
1.将x/y值转化为标准单位(SD)
2.求对应x/y值标准单位的乘积
3.求出平均值


例:  
x = [1,3,4,5,7]  
y = [5,9,7,1,13]  

求相关性系数  

首先将x/y对应数项转为SD值：  
x = [(1-4)/2 = -1.5, (3-4)/2 = -0.5, (4-4) /2 =0, (5-4)/2 = 0.5. (7-4)/2 = 1.5]  
y = [-0.5,0.5,0,-1.5,1.5]  
x平均数：4  
y平均数：0

其次求x/ySD表现下的乘积:  
 x * y = [0.75 , -0.25, 0.00, -0.75, 2.25]

最终通过计算x * y得到值的平均数，得到相关性系数：  
sum(0.75 , -0.25, 0.00, -0.75, 2.25) / 5 = 0.40

r值原理:  
通过x项y项平均值点引出垂线，并在平均数点相交，可以将散点图划分为四个象限。左下角和右上角x/y之积均为正数；而左上角/右下加x/y之积均为负，乘积之和为相关性系数。换言之，相关性系数是同时通过测算x 和 y两个单独变量在各自轴上的分布位置，判断两个变量是否都在相似的分布位置(平均数上/下)。如果x/y值分布均为正/负（均在平均数以上/以下），，即x/y分布位置相同，则两个正象限占主导地位;反之则相反。


相关系数（r）应该在+-1之间  
相关系数越大线性关系越强，当相关系数为1时被称为**完全相关**，即y=+-x的状态，所有点均位于一条直线（SD线）上，因此变量间存在**完全线性关系**。正常情况下，两个变量不会出现完全线性关系的情况。

相关系数仅仅是一个常数而不代表数据分布，即0.80相关性，即不代表有80%的点靠在线上，也不意味着其线性程度是0.40时候的二倍。  
相关系数分级：1.0-0.7强相关 0.7-0.3 部分相关 小于0.3被认为不相关

***相关性系数分布在+-1之间，且为+-1范围内的任意值。当正相关时散点总体方向为斜上，即自变量x增加时因变量y也会一同增加;负相关时则向斜下，即即自变量x增加时因变量y相对减小;***

### 相关系数的特点

1. 相关性系数只是一个纯粹计算出的指标/数字，因此并不会带有任何原始变量下的单位。同时，因为计算相关性系数时使用了标准差单位(SD)对x轴/y轴上的原始数据进行了拟合/转化。x轴/y轴上的数据同时乘或加一个标量数据并不会引起相关性系数的变化。（例如，x/y轴数据同时乘以3，则平均数，离平均数的偏差和方差均增加三倍；在计算方差时此倍数将会被消去；x/y轴同时增加一个标量时，平均数增加7，但是离平均数的偏差不变，方差也不变）
2. 根据相关性系数的计算方法可知，互换变量（x/y和y/x）相关性系数是完全相同的(x * y == y * x)
3. 当出现大量离群点，亦或者数据分布不成线性相关的情况下，相关系数无法完美的描述散点图：离群点的存在会很大程度上拉低相关性系数，甚至使其降至0。而非线性相关的情况下(随着x增加，y值先增后降，类似成年人体重和年龄之间的相关性)，此种情况下，即便两个变量相关，则相关系数亦是0.故，只要可能，则应该通过观察散点图检查/确定离群点和非线性相关：相关系数r仅适用于线性相关情况，而不是一般意义下的相关。

## SD线

相关性数据当中，用于拟合且表示散点图趋势的线被称作**SD线**。SD线穿过对于x/y两个变量的来说平均数的差都为SD的倍数的所有点。该线穿过平均数点，以美横向增加1SD，竖向增加1SD的比例上升。例如坚持人身高和体重的关系，若身高比平均身高多1SD且体重比平均体重多1SD，则此点落在SD线上，而若身高增加1SD而体重增加0.5SD，则不在线上

SD线的斜率是: 上升（+-Y的1SD值） / 前移（X的1SD值）

### 改变SD

散点图中，点形成的形状和点的密集程度均由标准差单位(SD)来决定：两个相关性系数完全相同的数据，因为SD大小的不同，而在散点图中显示的分布不同，SD越小越密集且离SD线越近；反之则相反。这是因为r的计算考察的不是按照绝对值度量集群程度，而是按照相对SD的值而决定。

***相关系数度量点围绕直线的集群的程度，但这只是针对SD而言的***

### 相关系数与距SD线的间距

***如果相关性系数r靠近1，则一个代表点在SD线之上/之下的仅为纵向SD的一小部分地方。如果相关系数r接近0，则一个代表点位于SD线之上/之下一定的量，在大小上大致与纵向SD是可以比较的。横向SD也是相同的***

## 相关性和因果性

***因果性不意味着相关性：相关性系数度量的是变量之间的相互关系，但是相互关系不等于因果关系。计算相关性系数不能帮助理清第三因素的影响***

例如：经检查，学校中儿童识字率和鞋尺寸的大小之间存在相关性，但这不意味着学习新词汇会引起鞋尺寸的变化，而是因为当中存在第三个自变量**年龄**，因为儿童成长学会了更多单词，且需要使用更大尺寸的鞋。

故，在实验中，仅能通过增加内部分组的方式，防止第三因素对相关性系数的影响。

## 和自然/生态话题下的相关性系数

***生态相关往往是基于比率或者平均数的，它们通常用于政治，科学和社会领域，它们更多的倾向夸大相关程度。因为在社会/生态等方面下存在大量的样本，往往宏观下的系数因为在偏性/误差及其他因素的影响下，往往和宏观数据不相符***

例子：通过研究吸烟率（按照人员计算）和肺癌死亡率这两个指标并绘制散点图，可以发现吸烟率（按照人员计算）和肺癌死亡率之间呈现正相关。最终发现吸烟率和肺癌死亡率两个数据呈现正相关，且相关性为0.70。

此类案例中，因为数据检查的人的吸烟率烟率/肺癌死亡率而非国家的吸烟率/肺癌死亡率，故应使用各个国内人员的吸烟率和肺癌死亡率，而非国家级别的吸烟率/肺癌死亡率和相关性系数进行比较。

例2：美国人口调查：受教育程度和收入的相关性：

在统计如此大范围内的数据时，应使用个人的受教育程度和死亡率进行分析：通过收集地理划分下的9个区域中的男性的受教育程度和收入水平的平均数，然后计算9对平均数据之间的相关性。如果仅仅使用每个区域的相关性系数去估计个人维度的相关性系数，则因为区域数据中存在大量数据散步和离群点，必须使用平均数将此部分*脏数据*排除在外。

# 回归

***回归方法描述的是一个变量如何地依赖另一个变量***

***回归线：回归线之于散点图，等同于平均数之于数据变。y关于x的回归线估计了相应于每个x值的y的平均数；在回归线上，平均而言，自变量以平均数为基点，每增加一个SD单位的数据，相应的y则增加 相关系数r * y轴SD个数据的值，这种通过相关系数估算每个x值对应的y的平均数的方法叫做回归方法***

即：y = y_mean + r * x(SD单位值) * y_SD

回归方法中涉及到自变量和因变量双方的SD值：  
x轴/自变量的SD值用于测量x的变动范围，而y轴/因变量的SD值则用于测量Y的变动范围。

## 回归方法与个体数据推断

根据上述定理，当仅仅知道自变量或因变量的时候，一方推断出另外一方；通常，研究人员通过研究求出回归估计，再对数据进行外推，并将回归估计应用于推算新的对象。

例：大学学生SAT数学分数（200-800）和第一年GAP（0-4.0）之间的关系，自变量（SAT数学分数）和因变量（GAP）数据之间的差距：  
SAT_mean = 550,  
SAT_SD = 80  
GAP_mean = 2.6
GAP_SD = 0.6
r = 0.4

若一学生SAT分数为650，求其GAP分数:  
SAT(标准单位下) = (650 - 550) / 80 = 1.25SD  
GAP相对平均数增加的单位 = 0.4 * 1.25SD = 0.5SD,即在SAT现有的数据下，GAP数据应偏离了平均数 0.5个GAP_SD单位  
当SAT分数为650，则其GAP分数应是：2.6 + 0.5 * 0.6 = 2.9

此定理在大多数情况下有效，但是无法用于正确预测离群点下的数据。而且，此类推断得到的数据仅能代表当下状态下数据的结果，适用范围很广。（例中推断的数据仅能用于当前案例，即仅能适用于当前学校内学生，对于外校学生无法进行估计，因为数据差异会很大）

## 使用回归方法预测百分位数

回归方法也可以用于推断/预测百分位数排序：如果通过预测得到百分位数为90%，则说明超过了90%的数据。

回归方法预测百分位时，主要需要在自变量和因变量均服从正态分布的情况下，依据正态分布面积/SD单位换算进行。

例：已知SAT分数及GAP分数均为正态分布，相关性系数r为0.4，当某个学生SAT分数排名为90%，求其GAP分数的百分位数

首先需要确定SAT 百分位数为90%时的所在的标准单位（SD）；通过题目可知，该学生SAT排名(百分数数)为90%。设定90百分数位置标准单位为Z，90%位置据100%位置相差了10%，根据正态分布可知+-Z位置数据占全部数据位置的80%（100%- 10% - 10%）;根据正态表可知，占据80%面积的标准差单位（SD）为+- 1.3SD，即可知x所在位置为1.3SD。通过回归方法可知Y所在位置为0.4*1.3SD，即0.5SD。根据正态表可知+-0.5SD所占面积，最终得到百分位数69%

***此类计算中，SD仅仅用于表示x/y点所在的位置，并未直接参与计算；而相关性系数r值才是计算的关键，百分位排序以正态规则的方式给出标准单位***

***在缺乏任何数据支持的情况下，正常情况下应预测数据为中位数。但是在得到部分具体数据的情况下，可以预测在中位数数据上/下进行浮动（预测一个物理很好的学生的数学成绩 v.s 制陶课程很好的学生的数学成绩）***


## 平均数图

平均数图：将每个自变量中对应的因变量的平均值使用点标出（x,y），并标注出该点所含的样本量的图表被称之为平均数图。

***回归线图是平均数图的光滑形式，如果回归数图正好是一条直线，则回归线和平均数图必然和为一条直线。***

当变量间存在非线性相关的情况时，不应使用回归线而是使用平均数图。

## 回归谬论与均值回归效应

***在所有考试/再考试的情形中，都存在一种现象：第一次考试成绩比较低的对象在第二次考试中分数均会平均提高，而第一次考试成绩较好的学生则会在第二次考试中平均下降。这被称之为回归效应***

1886年英国遗传学家Francis Galton在研究人类身高的时候，发现一个有趣的现象：父母平均身高高于人群平均值的时候，他们孩子的身高会比父母低一点，而父母平均身高低于人群平均值的时候，他们孩子的身高会比父母高一点。也就是说，下一代的身高会向均值“回归”。 Galton称之为“回归平庸”现象。

### 均值回归效应

均值回归效应出现的原因，是因为两此比较测试中测试对象/样本对象得到的分数不尽相同，这有可能是因为试卷中出题的知识点不同，考生当时的状态变化，运气等原因造成的。故从整个样本群体的角度去诠释数据时，数据总会向平均值进行集中，因为最终数据等于：考试观察到的分数 = 实际水平分数 + 机会误差。

从统计学上简单的解释，如果组变量X和Y不是互相独立的，也不是完全线性相关（即相关系数不等于1或-1），且X是自变量，Y是因变量，那么一定有X与其均值距离较远（标准差大），Y与其均值距离较近（标准差小）。所以说，均值回归现象是普遍存在的，距离均值越远，偏差越大，均值回归越明显。另外要说明的是这是一个统计规律，**只适用于群体，不适用于任何特定个体**。

故，根据上述推论可知：样本数据在SD线周围分布并不均匀（不会均匀的分布在SD线的上/下部分），在SD线下部（以X轴为单位），数据分布大量分布在SD线上方；在SD线上部，则存在大量数据分布在SD线下方。而针对回归线，样本数据则会大量分布在回归线的上方和下方。即：从总体数据来看，第一次考试成绩低的数据第二次考试成绩将上升，第一次考试成绩高的，第二次考试成绩将下降。

***回归谬论认为，回归效应出现的原因是因为某些重要的因素引起（未考虑统计学上随机起落的回归现象，造成不恰当的因果推论），而不仅仅是因为围绕直线散布所致***

***那么如何避免均值回归导致的误判呢，首先要认识到这个问题的存在，然后是对于某些指标，可以重复多次测量，取变化的平均值，从统计上尽量消除均值回归的影响。***

## 两条回归线

***回归线和相关性系数的求值方法的不同，导致了针对自变量/因变量的回归线可以画出两条回归线，这两条平均线将分别穿过自变量和因变量的中心***

# 均方根误差

如之前提到，在回归方法中可以使用自变量推算因变量；然而推算出的数据和实际数据间往往存在差距。这双方的差距被称之为**残差**。而经过计算的整个数组的残差，被称之为**均方根误差**。

## 残差

***残差：残差指的是实际因变量和回归线之间的差/上下的垂直距离。残差是使用回归方法进行预测的预测误差的图形表示。在散点图中，每个点都有一个残差，用于表示回归方法带来的误差。***

***残差 = 实际值 - 预测值***

通过对数据组中全部的残差进行均方根计算后得到的简约值，被称之为**回归直线的均方根误差（将所有残差值平方求和，求其均值，再开平方，就得到均方根值）**。

## 均方根误差

***均方根误差指的是：通过回归推算出的Y值/因变量值和实际因变量值之间的差值的平均情况；均方根误差以绝对数，度量了点沿回归线散布的情况；而相关性系数则度量了点沿SD线的散布情况***

均方根误差能提供：一个代表点距回归线的有多远。

***散点图中的点，按照与均方根误差大小相似的残差偏离回归直线（上/下），均方根误差与回归直线之间的关系，相当于标准差于平均数之间的关系***

数据的残差，实质上也**服从正态分布**，即：***68%的点实际分布在回归直线+- 1 均方根误差的范围内，而95%的点分布在回归直线 +- 2 均方根误差的范围内；大部分的数据都适用于此规律***

## 均方根误差的计算

关于自变量x和因变量y的回归直线的均方根误差的计算公式:**(1-r^2)开根号 * y_SD**  
**算式中应使用待预测变量/因变量的SD进行计算**；**因为计算均方根误差时使用了标准单位/SD，故均方根误差存在单位，单位和因变量的单位相同**

通过均方根误差计算可知：如果在r值相对较小的情况下，均方根误差值会相对增大，甚至可能接近/超过标准单位值。故可以论证：当相关性系数相对较小时，数据拟合较差，因为均方根误差较高。另一方面，通过均方根误差也可以了解到回归数据的拟合情况。

## 均方根误差计算的实质

均方根误差计算，实质上将相关性系数和因变量的标准单位两个数据联系在了一起。

**因变量Y的SD度量的是一个代表点在Y轴平均数点延长线之上/之下的距离**。即：如果不考虑自变量x仅用y的总平均数预测y值，则SD实际度量了误差的大致大小。而均方根误差代表了点在平均数之上/之下的距离，均方根误差小一些，因为回归直线更加接近散点。而均方根误差比SD小的精确因子则为 **(1-r^2)开根号** 个单位（即均方根误差是y_SD的(1-r^2)开根号倍）。

当r = +-1 和 r = 0 这三个极端情况下，可以确认均方根精确因子的正确性：  
当 r = +-1 时，自变量x和因变量y完全拟合，且SD线和回归线完全拟合，均向左上/右上延申。在此类情况下，回归线将穿过散点图中全部点且残差为0，且根据均方根误差因子计算公式(1-(+-1)^2)开跟号可推算，此时的均方根误差值为0，符合实际情况。  
当r = 0时，则证明自变量和因变量完全无关，即双方无线性关系。同时此时均方根误差等同于SD。

## 残差图

残差图类似于平均数图，即：保持自变量x位置数据不变，计算并显示x位置对应y值的残差（y值在回归线上下的+-距离）。

**残差图中，残差的平均数为0，且残差图的平均线是水平的（所有向上/向下的趋势都已经从残差中剔除，且表现在回归数当中了）**。

***在多元线性回归中，残差图可以更加灵敏的检查数据是否线性相关：当残差图中大部分数据趋向y轴为0时，残差数量最小，证明数据线性相关，反之则不符合线性相关。***

## 对纵向条形的考察

纵向条形图：在散点图中，根据单位在x轴中选取两个端点(一般为四舍五入为箱中心点的数据，即3.5，4，4.5)制成的条形图，用于确定条形图中含有的点的关系（因为X轴数据可以四舍五入为一个的原因，被设为一个箱）。

***当散点图中，所有纵向条具有相似的散布时，这个散点图会被称之为等方差的***

一般来说，等方差的散点图的残差图，是椭圆形的。检测等方差性的的最好办法，是检测残差图。  
当散点图等方差时，整个回归直线上任意一点的预测误差值相近。

***异方差性：当自变量上升时，因变量值上升，且数据散布同时上升。即无法通过自变量精确推送因变量***  
当散点图为异方差时，散点图的不同地方的回归方法偏离不同的量。  
在此种情况下，回归线的均方根误差仅仅是提供了一些平均误差--对于所有不同的X值。

**假定散点图是等方差的，且残差中没有一定格式，取一窄纵向条形图当中的点，他们的Y值与回归线上的偏差在大小上与均方根误差相近**。

## 纵向条中正态曲线的应用

当纵向条形图是等方差的，且数据厚厚密集于图的中部，而在两边相对稀疏，则可以使用*正态近似*对纵向条进行研究。

***考虑一个橄榄球型散点图中一个窄纵向条形图中的所有点，它的y值是一个新的数据集，新数据集的平均数使用回归方法估计，新SD约等于回归直线的均方根误差。正态近似可以像通常那样，但是需要使用新的平均数和方差***

例:LAST考试分数和第一年成绩之间的关系：  
LAST考试成绩平均数：32，SD：6  
第一学年平均成绩：68，SD：10，r = 0.60

求：当LAST考试成绩等于35分时，第一学年成绩在75分之上的学生占比

题目中在LAST考试为35分的数据部分形成了一个纵向条，为了求出纵向条部分数据中，因变量（第一学年平均成绩）75分以上的数据占比，则需要线算出纵向条选中区域的新平均数和方差后，利用正态近似的方法，求出该点Y值所在SD，并最终换算出Y值所在面积，最后求出Y值之外的面积。

1.计算纵向条区域内y的平均数：  
使用回归方法估计，即通过回归方法算出的该点的Y值，即为此纵向条中Y值数据的平均数：先通过x轴偏离平均数的sd判断Y数据偏离平均数的SD。(35-32)/6 = 0.5SD,x偏移平局数0.5SD，r * SD = 0.6 * 0.5 = 0.3SD，68 + 0.3 * 10 = 71，即新区间Y轴平均值为71。  

2.计算新区间范围的SD:  
新区见的SD值，可以使用均方根误差来代替：(1-0.6^2)开根号 * 10 = 8（通过LAST成绩求第一学年平均成绩，平均成绩为因变量，此处SD选8），即新SD为8。

3.使用新平均数和新SD。计算Y轴上的正态近似以计算百分位数  
(75-71) / 8 = 0.5，即Z = 0.5。由此结合正态表可以推出：+- Z所占总面积的38%，而75分以上面积占31%。

# 回归直线与多元回归

## 回归线的斜率和截距

任何直线都可以用**斜率**和**截距**进行表示，通过计算直线的斜率和截距，可以计算出直线的**直线方程式：y = 斜率 * x + 截距，即：y=mx+b**，回归直线也是直线，故可知：回归直线也可以使用直线方程式进行表示。

对于回归线而言，**斜率**意味着**x每增加一个单位SD，Y相应的平均变化的大小**；根据回归方法可知：自变量增加1个SD，因变量增加r个SD，y = r * x(SD表示) * y_SD + y_mean，故可知回归线的斜率计算为：**斜率 = (r * y_SD) / x_SD**

对于回归线而言，**截距则为X=0时的y预测值**

回归直线中的方程被称之为**回归方程 = (r * y_SD) / x_SD + 截距**

***回归方程是使用自变量x推算因变量y的另外一种方法，但是通过回归方程，研究人员可以通过小样本数据计算一次回归方程后，将数据直接带入到此方程中进行计算，最后得到预测值。***

例：通过受教育水平（年），计算平均收入，求回归公式，和 8/12/16年教育水平下的收入：
平均受教育水平：12年，SD：3.5年  
平均收入：11600美元，SD：10500美元，r = 0.40

1.求回归方程：  

根据回归方程公式可知：y = 斜率 * x + 截距，回归线中斜率等于(r * y_SD) / x_SD = (0.40 * 10500) / 3.5 = 1200美元 / 年，即每增加/减少1年教育收入将增加/减少1200美元。  
已知：截距等于x = 0 时 y的预估量，即受教育水平为0时的平均收入，根据斜率可知：每减少一年教育年限则减少1200美元收入。故，相对平均年龄的12年，当x=0时收入应减少 12 * 1200 = 14400美元；故，当受教育平均市场为0时，收入为 平均收入 - 14400美元 = -2800美元。（或可使用回归方法对数据进行估计，即：(0-12)/3.5 * 0.40 * 10500 + 11600 = -2800）

根据上述计算，回归方程为：y = 1200 * x + (-2800)

2.计算8/12/16年教育水平下的收入

将教育年龄带入回归方程中可得：  
8年教育水平下收入：1200 * 8 + (-2800) = 6800美元  
12年教育水平下收入：1200 * 12 + (-2800) = 11600美元  
16年教育水平下收入：1200 * 16 + (-2800) = 16400美元  

在回归方程的范围内，我们仅仅知道自变量和因变量之间存在**相应的关系**，而不是绝对相关。以上例为例，通过回归方程计算，我们仅仅可以知道受教育水平增加1年，相应的收入增加1200美元。但是针对收入的差异是否是受教育时间影响所产生这一议题，回归方程则无法解释；因为数据中可能混杂了其他原因，例如个人的智力，家庭情况等。这些因素和自变量因素实际混杂在一起，形成了回归方程中的斜率，最终影响了因变量。

针对上述情况，可以通过增加内部观察组的方法进行解决，或者可以通过进行**多元回归**的方法进行计算。

总而言之**在观察研究中，回归直线的斜率和截距都仅是描述性统计量，只能说明观察统计中一个变量的平均数如何与另一个变量的值进行相联系；如果研究者改变了X，则Y不一定/不能使用斜率来预测Y值的对应变化**。

## 最小二乘法

有时，散点图中的点沿着一条直线进行延申（线性关系较高，相关性较强），为了拟合此种情况下的散点图，可以寻找一条直线，保证散点图中的*点到此直线的距离相同(移动这条线将使得直线到散点图中某些点的距离增加，故找到和散点图中全部点距离相同的位置，即是拟合最好的位置)*。这时此直线即为*回归线*。  
为寻找到适合的位置，需要满足两个要求：1.定义一个直线到所有点的平均距离；2.在平均距离附件移动直线，直至平均距离尽可能的小。

针对第一个问题：  
因为此直线将作为回归线，用于使用自变量来推算因变量；故针对因变量/y值来说，点到此线的垂直距离，就是点到线的距离，即是回归方法中的**残差**；**统计学中，定义平均距离一般使用均方根进行**，这些点到回归线的平均距离则可以被视作**均方根误差**。

针对第二个问题：  
为在此点附近移动直线，使得均方根误差最小，**在所有直线中，由x预测y的均方根误差最小的那条直线，被称为回归直线**。  
而回归直线也被称之为**最小二乘直线：将误差平方以计算均方根误差，回归直线使得均方根误差尽可能的小**。

例：列文虎克计算弹簧的长度和负重关系：  
列文虎克通过在一个弹簧上加挂不同重量的砝码，计算出弹簧的长度和负重之间呈线性关系。  
假定弹簧在无负重时长度为b，悬挂x千克重物后长度为y，弹簧本身的材料系数为m。则可知弹簧长度和负重的关系为 y = m * x + b。  
此类实验中，m和b的值均需要使用实验得出，根据实验结果可知：

|重量(千克)|长度(厘米)|
|:---|:---|
|0|439.00|
|2|439.12|
|4|439.21|
|6|439.31|
|8|439.40|
|10|439.50|

因为这些点并未在一条直线上(相关系数为0.99)，穿过这些点的线可以有很多，但最适合的线中，**m和b将使得均方根误差为最小，这被称作最小二乘法，此时的y = m * x + b公式则为回归线**。  
此时数据的m为回归直线的斜率，b为回归直线的截距，这被称作**最小二乘估计**。**最小二乘估计，可以估计回归线的斜率和截距**。

相对于使用描述性统计方法（回归方法）拟合的数据，**使用最小二乘法拟合的数据会更加精准**，因为在正常实验和观察中，总会出现机会误差，导致使用一般拟合方法时存在误差。**使用最小二乘法拟合数据时，会使用到散点图中全部的点进行拟合；且因为取均方根误差最小的数据，则可以将随机误差降到最低**，得到的拟合回归线则会更加精准。

**最小二乘法和回归方法相似，但使用时机不同**。最小二乘法的使用时机则根据计算的实际情况而定。如果数据间相关性较强，可以使用最小二乘法进一步对数据进行更精准的拟合，如果相关性较弱，最小二乘法带来的好处相对较弱，则可直接使用回归方法。

## 回归是否有意义

回归直线可以在任何散点图中进行绘制，但是在计算回归线之前，需要了解：  

1. 变量间的关系是否为非线性关系，如果为非线性关系，则计算回归线会误导研究者。
2. 回归是否有意义：这应该基于数据产生的方式和逻辑进行判断，即因变量是否由自变量产生而产生，或者双方的内在关系。如果因变量和自变量之间没有完全的直接关系，而仅仅是间接关系。则计算回归线/回归方程仅仅会误导研究者，即便在相关性系数相对较强的情况下也是如此（毕竟相关性不同于因果性）

而针对多个影响因素共同影响数据的情况，则可以使用**多元回归**的方式*控制其他变量*。  
在拟合受教育年限和收入时，可以添加E：受教育水平，s：父母地位度量，相关公式则为 y = a + b * E + c * s

# 概率与机会

***统计：小范围样本推理总体；  
概率：通过总体推断下一次出现的小范围样本及其概率***

***机会的频数论，大多可以直接用于能够独立地在同样条件下一次又一次重复的机会过程***

***当某一个基本过程，在相同条件下独立地一次又一次的进行时，某事件的机会给出期望该事件发生的百分数***

例如扔硬币扔出1点的概率一直为六分之一。

机会的两个基本事实：  

1. 机会在0%至100%之间。如果某件事不可能发生，则机会为0%，反之某件事一定发生则机会为100%，一切机会则分布在这两个端点之间。
2. 对某件事的机会等于100%减去其对立时间的机会。如有45%的概率赢，则可推出55%的机会输。

## 终久论点

在随机情况下（保证每次测试均独立/互不影响，即实验对象外形/重量匀称，且每次实验后均将对象归位且打乱顺序），每个实验对象被抽取到的概率时相同的，即每个实验对象被抽取到1次的概率时相同的。无论是哪个分组的实验对象。

例：盒中装有若干外形/重量/手感完全相同，仅颜色（红色/蓝色）不同的塑料球，拿到红球得1分而蓝球不得分，以下哪种情况得分概率最高：  
* 盒中红旗3个蓝球2个  
* 盒中红球30个蓝球20个

两种方案下得分大体相同，因为两个方案中取到红球的概率相同，概率的计算均为：红球数 / 总球数，而不受蓝球/红球客观数量的限制  
这是因为在大量实验的情况下，两个方案抽取到红球的时间相同。第一个方案中，每个球同时被取到1次时，红球在3/5的时候出现，即取出数据的概率为3/5  
在第二个方案中，50个球的情况下，需要大约50次抽取后每个球被抽到1次，而红球将在30/50即3/5的时候被抽取到

***一件事发生机会的大小，将依据一件事发生的机会数 与一件事发生和不发生的机会数之比，即：发生概率 = 发生机会数 / 发生不发生的全部机会数。表示发生和不发生的概率的和为1，因为设想下两个概率的分子之和等同于公共分母***

在计算此类问题的概率时要注意，抽取实验对象后需要归位，保证每次抽取时样本对象完全相同。即取出球并记录后需要将球放回箱中并摇匀。

## 条件概率

***在求多次事件发生的概率中，给定第一次事件发生的条件，且第二次事件发生的概率被设置/基于第一次事件的结果，这种情况被称之为条件概率***

例：在一套52张扑克牌中抽取两张牌，如果第二张牌为红桃A，则得分，问：1.得分概率；2.翻开第一张牌为梅花7，求得分概率

1. 得分概率为 1/52，因为红桃A必定存在在当前牌中，一共存在52个可能的位置，故第二张牌抽取到红桃A的概率为1/52（红桃A出现在第一张牌中出现等同于未抽中）
2. 得分概率为 1/51，因为已确认了第一张牌的花色（并且在第二张牌抽牌时并未将第一张牌放回），即可以推断出在剩余的51张牌中（50张牌+第二张牌）中一定有1张红桃A，故第二张牌为红桃A的概率为1/51

上述例中，问题2中的概率1/51就被称之为**条件概率**，因为问题中被给定了第一次事件的条件，即：第一次为梅花7。统计时可以讨论：**如果**第一次为梅花7**且**第二次为红桃A的概率。  
同时，问题1中1/52则被称之为无条件概率，即没有限定第一次发生事件的概率。

***第二次为红心的概率可用数学公式P(第二次为红心)代替，P为概率/"Probability"缩写；已知第一次抽牌为梅花7，求第二次抽牌为红桃的概率可写为P(第二次抽牌为红桃|第一次抽牌为梅花7)，中间的直线表示"已知"***

## 乘法规则

***乘法规则用于求两个事件同时发生的机会，即两件事一起发生的机会等同于第一次发生的机会乘以已知第一次事件发生情况下第二件事件发生的概率***

例：盒子中存有三个分别印有"R","W","B"字样的卡片。首先从盒中取出一张卡片，之后再取出一张卡片（第一次取出卡片不放回），求第一次取出"R"而第二次取出"W"卡片的概率：

依据乘法规则第一次取出"R"字样卡片的概率为1/3，而第二次取出"W"字样卡片的概率为1/2，两者同时发生的概率为 1/3 * 1/2，即1/6。  
相关理解如下：第一次取出"R"牌的概率为1/3，这1/3的人中再进行一次取牌操作，取到"W"牌的人占1/3概率人中的1/2。  
或可以理解为：600人同时进行操作，其中200人取得了"R"牌，200人再次取牌后仅有100人取得"W"牌，这100人占全部取牌的600人的1/6。

## 独立性

***如果两件事被认定为互相独立，则如果给定第一件事，无论结果如何，第二件事发生的机会不变/不受影响；反之则证明两件事之间不独立***

比较标准的互相独立的事件是**抛硬币**：  
抛一枚硬币两次，两次抛出行为之间就是完全独立的：  
第一次抛出结果为正面不会影响第二次抛出的结果，即：第一次抛出正面的概率为1/2；第二次抛出背面的结果也为1/2；第一次抛出正面而第二次抛出负面的结果，根据乘法规则，则应计为1/2 * 1/2 = 1/4

例：盒中存在标识为"1","2","3"的黑色和"1","2","3"白色卡片各一套，从盒中随机抽取一张票时：  
1.抽取时发现票为黑色，则取出票面编号为"2"的概率为1/3  
2.抽取时发现票面为白色，则取出票面编号为"2"的概率同为1/3  
3.卡片颜色维度和卡片编号两个条件相互独立，因为：取出卡片的颜色不会改变卡片号码，故颜色和号码是相互独立的。

例2：盒中存在标识为"1","2","2"的黑色和"1","1","2"白色卡片各一套，从盒中随机抽取一张票时：  
1.抽取时发现票为黑色，则取出票面编号为"2"的机会变为2/3  
2.抽取时发现票面为白色，则取出票面编号为"2"的概率同为1/3  
3.卡片颜色和编号两个维度不独立，因为：取出卡片的颜色和编号出现的机会有关，即取出票的颜色不同，编号出现的机会也是不同的。

***随机有放回抽取时，各次抽取之间是独立的。不放回抽取时，各次抽取之间是不独立的***

***如果两个事件是独立的，那么两个事件同时发生的机会等同于各自无条件概率的乘积***

例：盒子中放置了5个卡片："1","1","2","2","3"；现在保持**有放回的方式抽取**，出现以下事件的机会为：  
1.第一次抽取为"1",第二次抽取为"2"的机会：2/5 * 2/5  
2.第一次抽取为"2",第二次抽取为"2"的机会：2/5 * 2/5  

当条件变为**无放回抽取**时则：  
1.第一次抽取为"1",第二次抽取为"2"的机会：2/5 * 2/4  
2.第一次抽取为"2",第二次抽取为"2"的机会：2/5 * 1/4

乘法规则这样的概率运算是为了处理机会游戏而创造的，在游戏中，可以在有限条件下进行多次重复的独立事件，但是现实生活中不存在如此完美的条件。  
***机会的数学理论适用于某些场合（条件/误差控制较强的场合）,而在另外一种场合中则会引起谬误***

## 枚举法/列举状态法

***在演算一个事件的机会时，有时枚举出/列出机会过程可能出现的全部状态是十分有用的；如果列出全部状态十分困难，则可以列出部分典型示例***。

例1：投掷*1枚*骰子，出现一个偶数的机会有多高  
使用枚举法时，可以列出全部可能出现的机会过程，此例中，任意投掷一枚筛子得到的机会过程为："1"，"2"，"3"，"4"，"5"，"6"六个点数；其中点数为偶数的机会过程为"2"，"4"，"6"三种。  
故,出现偶数的概率为3/6,即 50%。

例2：投掷*2枚*骰子，出现点数之和为2的情况即机会有多高  
使用枚举法列出所有可能：两个筛子的点数之间出现了笛卡尔积：  
筛子1:1,1,1,1,1,1,2,2,2,2,2,2......  
筛子2:1,2,3,4,5,6,1,2,3,4,5,6......  
最终根据乘法规则，第一此投骰子会有6种机会而第二次投骰子同样存在6种机会（1-6点），这两个骰子事件一起的机会一共有6 * 6 = 36个。  

    1，2，3，4，5，6  (第一次骰子结果)
    1
    2
    3
    4
    5
    6
    (第二次骰子结果)

而，投掷两枚骰子时，出现点数之和为2的情况只有一种，即"1","1"  
故，可知，出现两次骰子点数之和为2的情况的机会为1/36；  
**也可以通过计算乘法规则的方法求出此值，即：第一次投骰子得到1点的机会为1/6，而第二次投出骰子得到1点的机会也为1/6，两次机会相互独立，故两次投掷骰子结果为"1","1"的概率为 1/6 * 1/6 = 1/36***

如果引入第三个骰子，则情况还会再变化，即匹配得到的结果应为6 * 6 * 6= 216

## 加法规则

***加法规则：求两件指定事件中至少有一件发生的机会，先检查是否互斥/互不相容/不可能同时发生(检查是否会重复计算相容部分)，如互斥/互不相容，则可以将两次的机会相加***

### 互不相容事件

***两件指定事件中至少有一件发生的机会：或第一件发生，或第二件发生或两件都发生。其中两件事是否可能同时发生，由事件本身决定：如果两件事的发生互斥，即一件事发生会制止另一件事发生，则两件事不会同时发生***

从洗好的牌中抽出一张牌，这张牌*不可能即是红心又是黑桃*。  
如果为两个骰子投出得到"1","1"的结果这个事件，则不互斥：因为第一个骰子和第二个骰子结果之间相互独立。

例1：在52张扑克牌中，抽取1张牌，抽到红桃的概率是1/4,抽到黑桃的概率是1/4，问：收到红桃或黑桃的概率  
因为抽牌行为中，抽到红桃和抽到黑桃两个事件互斥（不可能同时发生），故相关概率为：1/4+1/4=1/2

例2：在投掷*2个*骰子时，得到*至少*一个1点的概率:  
因为投掷骰子这个事件中，每个骰子事件之间相互独立且互不影响，故无法使用加法规则(两个骰子皆投中1点的可能性会被重复计算)  
根据笛卡尔积可知：第一个骰子投中1点的事件为6，第二个骰子投中1点的事件数为6，而双方都投中1点的事件被重复计算了1次，故最终概率为(6+6-1)/(6 * 6) == 11/36；  
**或直接减去1次重复计算的双方皆为1的概率**：6/36 + 6/36 - 1/36 == 11/36

***何时使用加法规则而何时使用乘法规则，取决于：  
1、将机会过程简化为例1，例2两种情况；  
2、确定需要求出机会的事件  
随后试图将当前事件和已知机会的简单时间相联系，并计算简单事件中发生一次，或全部发生的概率  
当两个事件互斥时，如果想求至少一次发生的机会，则使用加法规则将两个事件的机会加起来  
如果想求全部发生的机会时，使用乘法规则***。

***通俗解释：  
加法法则应用于并列关系的事件  
乘法法则应用于不相干关系的事件  
如果把概率看成某些事件在样本空间中的占比，并规定数字1被分配到这些占比——也就是概率，则每一个概率都是一个小于等于1的实数。  
那么概率的乘法就是“一些事件在样本空间的占比”的乘法，由于所有占比（概率）都小于等于1，  
所以概率乘法是乘得越多其结果越小，这同时意味着某些事件的占比就越来越小了，换言之，它越不可能出现。  
比如：P(AB)=P(A)P(B|A) ，P(AB)实在太小了，小到比P(A)和P(B|A)都要小。如果有人先给出P(A)，要求你把它凑出P(AB)，那么你必须想办法把P(A)“压缩”至P(AB)为止，如此就给P(A)乘以一个小于1的权重让它变小至P(AB)吧。那么这个权重究竟是多少呢？对比P(AB)和P(A)，前者占比之所以比后者小是因为它要求事件A和B同时发生。因此你只需要找出一个占比让A缩至A∩B。现在考察P(B|A)，如果把P(B|A)看成事件B在样本空间A中的占比的话，那么很显然为了找出A与B的重合部分A∩B，你只需要将P(B|A)这一占比乘到P(A)上去。于是有P(AB)=P(A)P(B|A)P(AB)和P(B|A)之所以不一样是因为他们的样本空间不一样(前者是Ω，后者是A)，彼此的占比完全不是一回事。  
至于概率的加法，互斥的事件在样本空间中不重合，所以它们的占比之和可以直接作为几个互斥事件在样本空间的占比***。

***有时通过直接计算难以计算出机会的情况下，可以转换思路，即通过赢的机会 = 100%-输的机会，这一个定律入手，通过计算出每次输的机会/对立的机会再用乘法规则相乘，之后用100%减去结果，即是成功机会***

注意：实验以及计算过程中，所有条件均为理想条件，即骰子完全对称，每次投掷力道相同，且骰子没有灌铅。反之结果机会会有很大不同。

# 二项系数

***二项系数主要用于计算多次相互独立的事件中，某一个特殊事件出现的机会。例如：  
投一枚骰子10次，恰好得到3个1点的机会***

例：盒中存在1红球及9黑球，进行**随机放回**形式的抽取5次后，求恰好有两次取到红球的机会：  
使用枚举法可知，满足条件的形式可为：RRBBB形式，出现此类形式的机会为：1/10 * 1/10 * 9/10 * 9/10 * 9/10，即为(1/10)^2 * (9/10)^3。  
满足条件的另一个形式为BRBRB，出现此形式的机会为：9/10 * 1/10 * 9/10 * 1/10 * 9/10，同样可以被计为(1/10)^2 * (9/10)^3。  
经过实验发现，RRBBB形式和BRBRB形式机会完全相同，实际上每个恰好抽取到2个红球和3个黑球的形式下的机会都是相同的，这是因为抽取到2个红球的RR形式贡献了(1/10)^2的机会，而3个黑球BBB的形式贡献了(9/10)^3的机会，再根据乘法规则，两个形式组之间需要使用乘法连接。故，所有形式机会之和应等同于 *形式的个数 * 公告的机会*。  
而计算每一个2R3B形式的数量，得到的就是形式的个数。  

***二项系数可以计算多次独立事件中，一个固定形式出现的全部次数**  

***一个互相独立的事件中，一个固定形式出现的全部机会 = 二项系数求出的固定形式出现次数 * 成功时的机会^成功事件次数 * 失败时的机会^失败事件次数***

就上例而言，相关等式为 (5*4*3*2*1)/((2*1)*(3*2*1) = 10，即2R3B的格式会有10种搭配，最后等式为 10 * (1/10)^2 * (9/10)^3 = 7%

为了保证总结出的二项系数数据不会特别凌乱，数学家在一个数字前使用 **!表示阶乘/连乘，即这个数字与它前面的所有正整数一起相乘的结果**  
例：4！ = 4 * 3 * 2 * 1 = 24，读作*4阶乘等于24*，其中数学约定 0! = 1  

故，上例公式可以改为 5! /((2!)*(3!)) ，这是将 2R3B排列成一行的所有组合；分子种的5是分母中2和3的和。

例2：4R1B的排列方式组合个数：5！/(4！*1！)

## 二项系数公式

***一个事件在n次中恰好发生k次的机会由以下公式计算n!/(k! * (n-k)!) * P^k * (1-P)^(n-k)  
其中：n为实验次数，k为事件发生的次数，P为任何一次特定的实验时，k事件发生的次数  
使用二项式系数公式的条件为：  
1、n的值必须事先规定  
2、P的值必须对每次实验都是相同的  
3、实验必须是互相独立的***

例：一个骰子掷10次，得到两1点的概率：  
根据条件，每次骰子事件均为独立事件，且规定了总实验的次数，故可以使用二项系数公式：  
n=10,k=2,P=1/6；则二项公式为：10！/(2!*8!) * 1/6^2 * 5/6^(10-2) == 29%  

例2：投一枚骰子，直到出现6点为止，求出现2个1点的概率：  
因未规定事件次数，故无法使用二项系数求解。如果实验次数仅为1次，则实质是求投一次骰子结果为6的机会，以此类推

例3：随机放回的从装有1，1，2，3，4，5六个卡片的何种抽取10次，最后一次抽取前拿掉盒中的5号卡片：  
无法使用二项系数，此实验中实验次数给定，但最后一次实验前要拿掉卡片5，则最后一次抽取的概率将变为1/5而不是之前的1/6，故不能使用二项系数。

# 平均数率

作为互相**独立**的实验，一枚硬币**每次投掷时有50%的概率投出正面，且无论上次实验的结果是什么，故不会出现之前几次/上次投掷的硬币为正面，则下次投掷一定为背面的情况**。  
**补偿对于平均数律不起作用。举例而言，抛了10次硬币之后获得了10次正面，但平均数律并没有对第11次抛掷获得反面的概率进行补偿，它依然是50%**。  
经过大量测试之后，**投到正面的数量理论上等于投到背面的数量**。但实际情况下，因为机会误差出现的原因，**正面数=抛次数的一半+机会误差**；故从结果上看，**抛到正面的次数和期望数（总抛次数的一半）不会相等，且之间数量差距较大，但是和抛的次数的比值/比率差距很小**；这是因为，机会误差随着抛硬币的次数不断积累，故绝对数量会相当的大。而，随着抛硬币的次数进一步增加，则机会误差和总实验次数的比值/比率会相对**变小**。故最终可知：**相对硬币实验的初始部分，随着实验的进行，硬币抛到正面的次数和期望数（总抛次数的一半）的差值将上升，而比率将越发接近期望比率（50%）**

每次投掷硬币，抽到 正面 和 背面 的概率分别是 50%。所以10000次投掷后，我们期望获得5000**左右**的 证明 和5000**左右**的 背面，二者之和等于10000。这就是平均数律，它告诉人们***机会过程的结果是一个随机变量，但它不会偏离平均值太远**8。

**平均数率一般以百分数为措辞重述，尽管数据投出正面的百分率不会刚好是50%，但是在大量实验的基础下，将会尽量向50%的机会靠近**

## 机会过程

***机会过程是指一系列独立重复的随机试验，并且机会过程可以被抽象为盒子模型***。

通过上述实验数据可知，*因为机会误差出现的原因，事件数量会收到机会误差的影响，使其不再完全等同于预期数量*，这被称之为**机会变异**。故，计算机会误差造成的差距数量则至关重要，即计算*机会过程中确定的数据的误差*。在实际生活中，因为出现得机会变异，每次抽样得到得数据结果将不尽相同，有时这将影响到实验得结果；

例1：轮盘赌中输或赢的金额，或者说轮盘赌博本身即是一个机会过程，而赢或输的金额依赖于结果，且互相独立：轮盘再次旋转后，之前的赢家有可能变为输家。  
例2：通过抽样调查的方式，抽取部分选票，选票中民主党人所在的比率；此例中，抽取流程即为随机过程。所以，样本中民主党人的数量由运气绝对，且每个样本中的比率不同，另一个样本中，民主党人所在的比率很有可能出现微量不同。

机会过程控制的主要原则：***盒子模型***  
在所研究的过程（例如抽取选票）与从盒中随机抽取数之间的相似处  
把研究事件中的变异（民主党选民的估计），与从一只盒子中抽取的数之和的机会变异/机会误差之间建立联系。

***机会过程不是随机过程，因为机会过程的试验之间不具有时间相关性。举例而言，在一个盒子中有放回地抽取100次与同时在100个相同的盒子中抽取一次没有任何区别***。

***盒子模型：一个机会过程与从一盒中做抽取，这两者间的类似被称之为盒子模型；这是因为，如果将机会过程事件抽象为从盒中抽取数字之和的机会变异在数学上更加容易分析，许多负责的过程/事件都可以通过这种方法抽象并进行分析处理***。

机会过程和使用二项系数公式计算的数据不相同：**使用二项式系数计算数据时，已经给定了结果，仅仅在求结果出现的机会**。机会过程则在研究**指定条件和次数下出现的结果，和不同结果出现的机会**

## ‍机会变异（机会误差）‍

***机会过程的结果相对于平均值的偏移称为机会误差***。

机会误差可以是绝对误差：  
10000次抛硬币试验获得的头像总数 - 5000

也可以是相对误差：  

    absolute（10000次抛硬币试验获得的头像总数 - 5000）/ 5000

***机会变异告诉我们：  
当抛的次数增加时，头像数与抛的次数的一半之间的差变得较大，但是头像的百分比与50%之间的差异却变得较小。
也即，随着试验次数增加，绝对误差有增大的趋势，而相对误差有减小的趋势。***

## 盒子模型‍

每次抛硬币可以类比成从一个盒子中有放回地抽卡片，这个盒子里只有两张卡片，上面分别写着 0 和 1。

如果用卡片 1 代表头像，则10000次抽取后，所有取得的卡片数字的总和就等于在抛硬币10000次后获得的头像数。
从一个盒子中*有放回地抽取*标有数字的卡片就是一个*机会过程*，而我们关注的随机变量是卡片上数字的和大概有多大。

### 抽得数之和：盒子模型的基本形态

例子：盒子中存在6张卡片【1，2，3，4，5，6】，随机从盒中抽取一些票，求抽取得票总数之和。抽取事件基于**随机放回**步骤：抽取前摇动盒子混匀卡片，抽取时随机取出卡片并记录，抽取后将卡片放回盒子中并摇匀，准备下一次得抽取。  
**有放回**规定了每个抽取事件均为独立事件，即确定了每个抽取事件基于同样调剂，存在相同概率。  

如果，随机有放回得抽取两次，每次抽取1张卡片，求两次抽取卡片得总数之和(第一次3，第二次5，总数为8；第一次3，第二次3，总数为6)存在多种可能，**因此2次抽样数据得到数据加和后得值受机会误差得影响：如果抽取得到得数据为1种情况，则它们得和为一种情况；如果抽样的状态不同，则得到的和也不同**。  
问：从盒中抽取25次，结果之和大概有多大。  
因为每次抽取的卡片不同，而卡片之和也不仅相同，故重复25次抽取的事件10次，最后得到的结果也不尽相同；  
通过计算机重复进行实验可知，数据结果为88，84，80，90，83，78，95，80，89。值的范围从最小的78到最大的95，出现了肉眼可见的分布变化。  
原则上来说，值得变化范围可为25 * 1 直至 25 * 6；而实验中数据的分布范围为75-100。而随机过程则在研究：随着实验次数的继续增加  
1.数据的趋势是否会保持不变  
2.和所在75-100区间的机会为多少  

上例即为大富翁类游戏中常见的一种规则：投一对骰子，根据两个骰子得到的结果之和确定在游戏中前进的步数。掷骰子即可抽象为从盒中取卡片。

### 建立盒子模型

***盒子模型构建的目的，是为了分析机会变异，在构建盒子模型时，有三个基本问题需要先考虑：  
1.什么数字进入盒中  
2.每一种数字有多少张  
3.抽取的次数有多少***

盒子模型的使用：以Nevada赌轮为例：  
Nevada赌轮中存在38个球袋（38个选项）00,0,range(1-36)，除了0，00两个涂有绿色的球袋，其余36个球袋交替涂有红色/黑色两种颜色。旋转转盘并将球放置到盘中，让其落入到38个球袋中，根据打赌的游戏规则确定输赢；  

规则1：猜花色，如果落入红色球袋赢（本金 * 2），落入黑色或绿色球袋则输（失去全部赌注），每次押注1元；  
针对此类问题可以使用盒子模型：  
1.针对盒子内数据：因为模型仅涉及到挣钱和亏钱，则盒中票需标注+-1元  
2.每一类卡片的数量：例子中，18个红色球袋落入1个就算赢，18个黑色球袋和2个绿色球袋落入1个就算输，故应该准备38个卡片，其中18个标注了+1元，20张-1元，即：【18张1元，20张-1元】

就涉及到的机会来说，把1元押在红色球袋就相当于从上述盒子中抽取1张卡片。  

***盒子模型的最大好处，就是可以撇去研究事件中所有不相干的细节，仅仅表示/突出最重要的信息***，例如此例中的赌场，轮盘，荷官等。

求问题：每次押注红色，进行10次，求净利润：  
回到盒子模型中，进行10次赌博相当于有放回在盒子中随机抽取10次（两者均为独立事件且机会均等）。净利润则是这10次抽取的标数之合。  
作为可能的结果，10次抽取结果可为：R,R,R,B,G;R,R,B,B,R（R:Red；B:Black；G:Green）；结果及净利计算如下：

|赌博状态|R|R|R|B|G|R|R|B|B|R|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|输/赢钱数|1|1|1|-1|-1|1|1|-1|-1|1|
|净利|1|2|3|2|1|2|3|2|1|2|

根据上述规则：净利润根据抽得卡片标注的金额总额进行计算，得到红色净利润+1，得到绿色合黑色净利润-1；故净利润为2。

规则2：押1元至Nevada轮盘中任意数字，数字出现时赢35元，出现其他数字时输掉押入的1元（这被称之为打1赔35），如果进行100次实验，且每次都花费1元押在数字17上，净利润应是随机放回式的从盒中抽取多少次得到数据之和。  
解析：设定盒子规则：规则中赢得到35元而输得到-1元，故牌面中仅为+35及-1两种；根据规则，只有从38个球袋数字中取到指定的1个数字就算赢，反之37个取到事件被算做输，故牌中存在1个+35牌及37个-1牌：【1张35，37张-1】  
抽取的次数需要合进行实验的次数相同，即为100次，且每次抽取之后需要放回，从而不改变每次实验的机会。

***盒中标明在单次下注中能赢/输的各种不同的金额；  
从盒中抽取的任何一个特定数字的机会必须等于单次下注时赢得那一金额的机会（此处为数学上的赢，赢得一个负金额等价于赌博中输掉这个金额）  
抽取的次数等同于下注参赌的次数  
净利润等于所有卡片标明数据之和***

# 期望值与标准误差

***随机过程中产生的数围绕着数据的期望值进行变化，变化的幅度基本上遵循标准差。  
如果机会过程仅仅产生了一个数据，则此数据将会在期望值和周围大概相差了一个标准误的某处***。

## (机会过程中的)期望值‍

例：从盒【1,1,1,5】中*有放回的随机抽取*100次，求抽得的卡片总数。  
题中使用有放回且随机的方式抽取卡片。故每次抽取卡片的过程均为随机。其中卡片总数为4，包含1个5号及4个1号卡，故单次抽取到1号卡的机会为3/4，而抽取到5号卡的机会为1/4；  
故，100次抽取后，应获得100 * 3/4 = 75张1号卡和 100 * 1/4 = 25张5号卡。故最终分数之和为：25 * 5 + 75 * 1 = 200。  
此时的"200"即是期望值。

***当每次随机有放回的从盒中抽取卡牌时，每次抽取都将抽取一个大约等于盒子中卡片号平均数的量***

故，总结可知：  
***随机放回地从盒子中抽取所得数之和的期望值等于（抽取次数）×（盒平均）  
盒平均数，即单次的平均期望值 = (盒中全部卡片点数之和) / (盒中全部卡牌数)***

上例中，盒平均数 = （1+1+1+5）/4 = 2；故最终，此例中期望值应为：2 * 100 = 200

例2:假如有这样一个盒子：  
【1，1，3，5】

它的盒平均是：  
（1+1+3+5）/ 4 = 2.5

如果做100次抽取，我们期望卡片和为：  
100 × 2.5 = 250 左右。

***机会过程的期望值其实就是之前提到的平均值***。

例3：游玩Keno游戏时，规则上押1元钱有1/4的机会赢且获得2元回报（并收回本金），输一次则失掉本金，求进行100次游戏后的利润。

根据上述规则可建立盒子模型：【-1，-1，-1，+2】，盒平均为：（-1-1-1+2）/4 = -1/4，即每次游玩期望值为-0.25，而100次游玩后应为-25元。

## （机会过程的）‍标准误差/SE‍与平方根法则

***在实际情况下，盒子模型的期望值和实际值并不相等，这是因为存在机会误差的原因，实际盒子模型的最终值应等于 期望值 + 机会误差***。

***‍‍平均数律与‍机会变异定性地描述了机会误差与试验次数之间的关系。而标准误差可以定量地衡量机会误差。  
一个和可能在它的期望值附近，但是偏离一个其大小与标准误差相似的机会误差  
最终值的机会误差和抽取总结果相关***。

为了计算一个抽取中的机会误差，可以使用**平方根公式/平方根法则**:  
***在从装有标上数字的卡片的盒中作随机有放回的抽取时，抽得数之和的标准误差是***：

                平方根(开根号)/SquareRoot ( 抽取次数 ) ×（盒子的SD）

公式由两个部分组成：*抽取次数的平方根* 和 *盒子的SD*；  
这里的机会误差是绝对误差，SD是盒子中卡片数字的标准差，此时的SD用于测量盒子中所有值的散布，显示了数字的离散程度。  
可以看：**出机会误差随着抽取次数的增加而增加，但是增加的速度慢于抽取次数（抽取次数越多，结果更加无法预料，但因为平方根的存在，抽取造成的误差增加速度相对较缓慢）；盒子中卡片的数字差异（SD）越大，机会误差就越大**    
后者不难理解：  
【5，5】，【1，9】  
这两个盒子具有相同的盒平均（等于5），左边的盒子SD=0，无论抽取多少次都没有机会误差。右边盒子SD>0，它具有机会变异的可能。

***平方根法则的原理是互相抵消：每当抽到高于平均数的值时，抽到低于平均数的值的情况也即将发生；  
故，最终误差将被抵消到一定程度，故抽到的数之和相对接近于期望值***。

【标准差SD】 和 【标准误差SE】 不同。前者衡量**一系列数字的离散程度**，后者衡量**机会过程中的机会变异**。


例：针对盒子【0，2，3，4，6】  
有3种抽取方案，分别是抽取25次、100次和500次，每种方案执行100次

盒平均 = （0+2+3+4+6）/ 5 = 3
卡片标准差 = 2

所以三个方案的期望分别是：3*25=75,  3*100=300,  3*500=1500  
所以三个方案的标准误差分别是：squareRoot(25)*2=10,  squareRoot(100)*2=20,  squareRoot(500)*2=44.72

最后分别求出了3种方案平均机会误差的绝对值和相对值。

从结果可看出: ***随着试验次数的增加，机会误差发生变异，变异的趋势是：  
绝对误差增大，相对误差减小。  
并且绝对误差在标准误差附近  
原则上来说，机会过程最后的结果的绝对误差可以为0，而最大可为25 * 6；但大多数情况下不会超过2SE - 3SE***。

## 正态曲线与机会过程

***当实验/事件的次数达到一定程度(充分大)时，可以利用正态曲线计算机会过程之和落在一定范围内的概率***。  
可以发现：***随机过程得到的数据之和符合正态分布，即因每次抽得总数之和的机会误差，数据分布在期望值左右。此时期望值可被视为正态曲线的平均数，而标准误差则充当正态分布中的标准单位的角色***。

根据上述定理可知：***正态分布曲线下的面积即为随机过程数据之和落在指定数据（正态曲线面积的两个端点）下的机会***；  
上述方法一般用于计算**随机过程数据之和在某个指定范围之内的机会，具体步骤为：  
1.基于实际情况设置盒子模型  
2.基于盒子模型中的卡片及面值计算期望值和标准误差  
3.基于期望值和标准误差及范围数据拟合正态曲线，标准单位  
4.基于标准单位拟合正态曲线下的面积，最终计算出在指定范围内的机会**。

例1：针对盒子【0，2，3，4，6】  
抽取25次，求数据在50-100之间的机会。

上例中：  
单次期望值 = (0+2+3+4+6)/5 = 3  
整体期望值 = 3 * 25 = 75
标准差 = 平方根(((0-3)^2 + (2-3)^2 + (3-3)^2 + (4-3)^2 + (6-3)^2)/5) = 2  
标准误差 = 平方根(25) * 2 = 10  
根据提供的要求（50-100范围内的机会）可知，此范围的左右端点为50和100，根据上方计算可知：  
50所在位置的标准单位为(50-75)/10 = -2.5 SD；100所在位置的标准单位为：(100-75)/10 = 2.5 SD；  
根据正态表中数据，+-2.5SD所在正态曲线中面积为99%，即可得出结论:上述例子中的情况，连续进行25次事件的数据和，在50-100范围内的数据应占99%。

***对于标准正态分布，随机变量落在 [-SD, +SD] 范围内的概率是68%，[-2SD, +2SD] 范围内的概率是95%***。

例2：针对盒子【0，2，3，4，6】  
有3种抽取方案，分别是抽取25次、100次和500次，每种方案执行100次

类比上面的第二个方案，期望值是300，标准误差是20，对应的1个标准误差范围是 [280, 320]，2个标准误差范围是 [260, 340]。经过统计，落在 [280, 320] 内的方案执行数是72个，接近68%的比例；落在 [260, 340] 内的方案执行数是96个，接近95%的比例。

例3：Nevada赌轮下，赌徒每次仅将1元押在红色部分上(38个球袋中占据18个球袋)，进行10000赌博，求*庄家*净利润超过250美元的概率。  
根据之前的条件可知：押颜色游戏中，压1元时赢得1元(本金返还)，输时本金不返还；故，根据上述全部规则，盒子模型可为：  
【20个1，18个-1】（**根据上述规则，此时计算得是庄家得净利润，因为庄家和赌徒在此模型内为对头，故庄家赢时赌徒输，故代表得18个黑色和2个白色为赢时得颜色**），  
单次期望值：(1 * 20 - 1 * 18) / 38 = 0.05元，即每次赌博庄家平均赢0.05元  
10000次时间后得期望值：0.05 * 10000 = 500 元  
标准差：1元
标准误差：平方根(10000) * 1 = 100元
利润超过250美元所在得标准单位：(250 - 500)/100 = -2.5 SD  
根据正态表可知：+-2.5所在位置占全部曲线得99%，故之外得位置共占1%左右，而一边占0.5%；故-2.5起始至百分位数100%，共占正态曲线得99.5%。

上例说明了为什么十赌九输的原因：***因为在期望值的净利润为负的情况下，一切赌博的事件的最终净利润都会是负数***。唯一给赌徒的救赎，就是标准误差。

## 输赢仅有两种面值的情况下，计算标准单位/标准差得方法

***当盒中仅有两个面值的卡片（输和赢两种情况下的卡片）时，可以使用一条更加简便的方式计算标准单位/标准差：标准单位/标准差 = (卡较大面值数 - 卡较小面值数) * 平方根(较大面值卡占比 * 较小面值卡占比)***。

例：针对盒【1，1，1，5】，求标准差：  
因盒中票的面值仅有5和1两种，故可以使用次方法求SD：(5-1) * 平方根(1/4 * 3/4) = 1.73

例2：赌徒在赌Nevada赌轮时，每次均花1元押10号球袋上，已知当前规矩为打1赔35（押1元，赢时得35元；输时输掉本金。），求100次游玩后得期望值和误差  
根据上例可建立盒子模型：【1张卡+35元，37张卡-1元】  
故，单次平均期望值：(35 * 1 - 37 * 1)/38 = -0.05元，即平均每次时间赌徒将赢-0.05元（输掉0.05元）  
100次游玩得整体期望值为：100 * (-0.05) = - 5元，即100次游玩后，赌徒将赢得-5元  
因例中盒子模型仅存在两个面值得卡片，故可以使用快捷方法求标准差：(5-1) * 平方根(1/38 * 37/38) = 5.76  
故标准误差应为：平方根(100) * 5.76 = 58元，故赌徒进行100次随机过程后，净利润应为-5 +- 58 元（**大SE给予赌徒赢得更多钱得诱惑，但是也有可能输的更惨**）

## 分组与计数

使用平方根，可以**计算某些随机过程中的数量及其标准误差**，前提条件是需要正确的建立盒子模型。  
***根据需要进行的随机过程中的新条件（针对特定牌面值的计数），应通过修改并建立新的盒子模型的方式模拟新的情况***。

例：投骰子60次，求：1、骰子总数的范围和标准误差；2、6点出现的个数和标准误差；  
根据上例可建立盒子模型：【1，2，3，4，5，6】，  
故平均单次期望值为：(1+2+3+4+5+6)/6 = 3.5  
故60次投掷的期望值为 60  * 3.5 = 210  
经过计算可知：盒中面值标准差/SD为 = 1.71  
故标准误差为：平方根(60) * 1.71 = 13  
故，第一题中，60次掷骰子总数在210上下13左右

针对第二题，应修改之前的盒子模型：题中希望得到骰子投出"6"的次数，根据新的条件可知：一个骰子中仅有一个"6"，而仅有投中"6"可被设置为赢(为了计数，投中"6"可计为1，未投中则投中"6"的次数应不变，即为0)；  
故：新的盒子模型可以修改为：【0，0，0，0，0，1】，即投中1时投中"6"的次数加1，反投中"6"的次数不增加  
此时，单次平均期望值为：(0+0+0+0+0+1)/6 = 1/6，即投6次中会有一次投中"6"点，和投中"6"点的机会相同  
经过60次投掷后的期望值为：60 * 1/6 = 10，即投60次骰子中，会有10次投中"6"点。
此时，因牌面中仅有【1，0】，故可使用快捷方式计算标准差/SD：(1-0) * 平方根(1/6 * 5/6) = 0.37  
故，标准误差为：平方根(60) * 0.37 = 3  
最终可知：投60次骰子中，投中"6"点的次数为10次左右+-3。

**尽管很多机会过程相关的问题看似不同，但是可以使用相同的方法进行解答**：  
就上例而言，问题被分为了2类：  
1.随机从盒中抽取部分票，对抽取到的数据实施运算，并要求返回给定区间内的机会（例：从盒【1，2，3，4，5，6】中随机抽取60次，求总和在200至225之间的机会）  
  **此时抽取一般作为定量数据的来处理，一般可以相加，且对抽取所实施的运算为加法（此次抽取的点数是多少，并加总到总和数量上）**。
2.随机从盒中抽取了若干数量的卡片，求某一个标号卡片出现的次数，及在给定范围内出现的机会（例：从盒【1，2，3，4，5，6】中抽取60次，其中抽得"6"的次数在10-20之间的机会）  
  **此时的抽取是作为定性数据来处理的，对抽取到的数据实施的是分类和计数（每次计算时，在求得是：此次抽取中得到得结果是否为"6"，随后增加抽取"6"的次数）**  
故，***针对相似的问题，可以使用定量/定性；加法/分类计数两个方法，但是从根本上，仅仅需要通过改变盒子模型就可以实现不同方向的计算***。  

***如果必须对抽得的数据进行分类和计数，则可以改变盒子模型；将盒中卡片计为0/1两个类别，其中需要进行计数的卡片计为1而其他卡片计为0***

例：针对抛硬币得到正面的计数：抛硬币100次，1、求得到正面的次数范围；2、和次数在40-60之间的机会。  
根据例题可知，抛硬币共有两个可能结果：正面(赢)和背面(输)，故可设置盒子模型为【1，0】  
根据盒子模型可知：单次抽取到到正面的期望值为(1+0)/2 = 0.5，即每次投硬币，得到正面的次数是0.5次，  
故根据题中100次投掷要求下，得到正面的期望值为：100 * 0.5 = 50，即投掷100次硬币应得到50次正面；  
因盒子模型中仅有【1，0】两个卡面，故次模型可以使用*平方根法则*计算标准差/SD：(1-0) * 平方根(1/2 * 1/2) = 1/2  
故，此模型下的标准误差/SE应为：平方根(100) * 1/2 = 5；  
故综合上述条件可知：投掷100次硬币可得到50次左右+-5的正面；  

同时，根据上述条件可知：40-60次数在此随机过程中形成的正态曲线所在的标准单位为：40：(40-50)/2 = -2SD；60：(60-40)/2 = 2SD；  
根据正态表可知：+-2SD所占正态曲线的面积为95%；故可知：投掷正面次数在140-60的机会为95%；

## 平方根法则与平均数率

***假设抛一枚硬币大量的次数，根据平均数率可知：正面数 = 抛出正面的期望值 + 机会误差；  
根据平方根法则，抛硬币事件中的机会误差 = 平方根(抛硬币次数) * 1/2(抛到正面的SD)  
标准误差随着抛硬币的次数而增加，例如在抛10000次硬币时，标准误差为平方根(10000) * 1/2 = 50；  
当抛硬币的次数增加至1000000时，标准误差同样增加。不过因为计算时使用了平方根的原因，在1000000次抛硬币下，标准误差为 500。  
即：当抛硬币的次数增加时，标准误差/SE的绝对值将越发上涨，但是相对于抛硬币的次数而言，因为进行了平方根计算的原因，标准误差相对减小；  
这就是随着抛硬币次数的增加，抛到正面的比率相对增加且接近期望值50%的原因；平方根法则就是平均数率的数学解释***

# 概率直方图的正态近似

按照平均数率，一枚硬币在被投掷充足的次数后，正面出现的比率应接近50%。此实验是基于以下假设进行的：每次抛硬币都是独立的，且每次抛硬币的结果，即出现正面/背面的机会是均等的。  
基于平均数率可知，在抛出5次硬币时，正面和背面互相存在 2^5=32 个不同的组合，在这32个组合中有20个组合抛到正面的机会接近一半（5次事件中存在2或3次正面）；

根据之前的发现，平均过程可以使用正态曲线进行拟合；而实际上，平均过程拟合正态曲线的过程使用的是平均过程**概率直方图**拟合而成的。通过拟合后的正态曲线，可以计算任意投中正面的情况的机会。

## 概率直方图

如之前所说，直方图存在的意义便是使用面积表示各个分组的占比。概率直方图也不例外。  
***概率直方图表示的是指定箱(Bin)下的总体机会，而不再是绝对值数据***

类似于其他类型的直方图，**概率直方图用面积表示实验中指定组出现的次数占总实验次数的百分比**；  
例：投两个骰子10000次，求每次的点数之和；  
针对前100次投骰子得到的结果，其中投得点数之和为7的次数为20次，占全部100次投骰子的20%；  
故，在针对前100次投骰子事件的概率直方图中，点数7所在的直方图的面积应占20%。  

在经过100次，1000次及10000次事件之后，随着事件次数的上升，每次观察时的经验直方图（由实验观察到的结果绘制的直方图）将逐步收敛成为理想的概率直方图，即在大概率上拟合了对应的正态曲线的概率直方图。

***概率直方图使用面积表示机会，直方图由矩形组成，对于抽得数之和，每一个矩形的底以可能值得中心（例如上例中，可能值为7，则图形底为6.5-7.5的位置），矩形得面积为获得该值得机会，直方图得总面积为100%***。

一般情况下，概率直方图中，每个可能的值为一个单独的箱(Bin)，而每个箱都存在一个指定的占比，即是Y轴对应数据。

## 概率直方图与正态曲线

概率直方图和正态曲线的绘制方法中存在一定不同：根据上方经验可知：概率直方图跟进每个单独的箱和箱对应的占比进行绘制；通过概率直方图及原事件提供的数据可绘制正态曲线，而正态曲线则使用标准单位为底，且Y轴单位为针对每个标准单位所占的百分比形成对象的面积绘制而成（可以使用标准单位/标准误差换算关系搞清每个标准单位下所占的面积）。

通过绘制100次，400次及900次抛硬币得到正面的次数的概率直方图可以发现：直方图和正态曲线的拟合越来越好，从之前的略有锯齿至之后的完全曲线拟合；  
这也正面了平均数率的存在：随着实验次数的上升，数据分布逐渐收敛

## 正态近似：正态曲线推算出现次数机会的逻辑原理

例：1枚硬币抛100次，求正面数：  
1.在45-55之间（含端点）  
2.在45-55之间（不含端点）  
3.恰好为50

针对之前得到的数据可知：  
此例中，100次抛硬币得到头像期望值为50  
此例中标准差为1/2  
此列中标准误差为5

使用概率直方图求解时，问题1：  
问题1可化解为概率直方图中，底数为45-55的箱的面积之和；因为概率直方图和正态曲线之间拟合度很高，则实质等同于求至此段正态曲线的面积。  
而在概率直方图中，箱的面积为底数四舍五入的值（45：44.5-45.5）  
故，此问题所求结果为概率直方图中，底数在44.5至55.5之间的面积  
44.5和55.5，通过转化为标准单位后，数据为-1.1 和 1.1  
故，实质上是在求标准单位-1.1 - 1.1 之间正态曲线的面积  
根据正态表可知,-1.1 - 1.1之间的面积占正态曲线的72.8%，  
故题1结果为72.8%

问题2：不含端点时的45-55之间的（不含端点）机会，等同于概率直方图中46-54之间的直方图的面积；  
即45.5-53.5之间的面积  
等同于+-0.9个标准单位之间的面积  
根据正态表可知，+-0.9个标准单位之间的面积可约等为68%，故题2中机会为63.19%

问题3：正好在点50（期望值）位置的机会，等同于概率直方图中底数为50所在的箱的面积；  
即49.5-50.5之间的面积，换算为标准单位为+-0.1SD  
根据正态表可知，此处面积占7.97%；故最终得数为50时的几率为7.97%

***正态近似，是在计算概率直方图的面积之前，使用正态曲线替换实际概率直方图进行计算的方法；这种替换仅能在概率直方图符合正态曲线时才合理。  
近似的意思是：概率直方图的面积常常难以计算，而正态曲线下的面积则可以使用正态表进行查询***。

**通常情况下，如果问题仅仅要求回答两个点之间的机会，且没有规定端点，则可以直接将机会之和换算成，标准单位后进行正态曲线面积的计算，计算端点得到的机会结果固然精准，但如果矩形面积不大，或没有特意对端点/精度进行要求，则可以使用此种方法近似的得出机会**。

## 正态近似的范围

***针对从盒中抽取的情况，盒中诸数的直方图偏离正态曲越大，则在取近似之前每次事件需要的抽取数就需要越多***

例如【9个0，1个1】，此盒的概率直方图向0倾斜较大，而抽得数据之和的概率直方图也会向0倾斜。  

***当事件重复次数大时，经验直方图可以收敛为概率直方图（抛硬币实验）；当抽取次数大时，和的概率直方图更加接近正态曲线（盒中抽取实验）；因此，当事件的重复次数和抽取次数都大时，和的经验直方图将更加接近正态曲线***。

正态曲线一般与抽取数据之和有关，针对抽取数据之乘积的情况，正态曲线将非常不同；这是因为计算结果成绩的原因，曲线将更加离散，即一些质数将不会包含在曲线当中。而随着事件数量的增加，数据本身的分布将更加极端。

***当使用随机放回的方式在一个盒子模型中进行抽取时，即使盒子所装的票子面值并不遵循正态，但是抽得数据之和的概率直方图必将遵循正态曲线。  
在计算中，直方图必须换算成标准单位，且抽取的次数必须适当大（直到概率直方图完美拟合正态曲线）***  

一般来说，抽取的数量很少有一个确实的**适合大**的标准，因为抽取的数量依赖于盒子中卡片牌面的面值分布。但一般100次抽取得到的概率直方图已经可以很好的拟合对应的正态曲线了。

当概率直方图拟合正态曲线时，正态曲线可以使用期望值（代平均值）和标准误差/SE（代替标准单位/标准差）对曲线进行刻画，因为概率直方图可以完美拟合正态曲线：  
***期望值将概率直方图的中心定在水平轴的指定位置上，而标准误差则确定了概率直方图的散布***。  
而根据之前所知：***使用平方根法则时，期望值和标准误差可以使用以下数据求出：  
抽取次数  
盒平均数/单次抽取平均期望值  
盒SD***
因此，这三个值确定了抽牌结果之和的的行为，即为何盒子的SD成为其散布程度的一个重要度量的理由。